<!-- BragiApp\posts\templates\posts\post_edit.html -->
{% extends "base.html" %}

{% block title %}Edit Post{% endblock %}

{% block content %}

    <!-- Back Button -->
    <div class="text-left" style="position: sticky; top: 0; margin: 0; padding: 10px; background-color: #FFFBFF; z-index: 1000;">
        <button onclick="window.history.back();" class="btn btn-light">
            <i class="fa-solid fa-chevron-left"></i> Back
        </button>
    </div>

    <!-- Status Message -->
    <div class="container mt-4">
        <div class="alert {{ post.status|yesno:'alert-success,alert-warning' }} text-center" role="alert">
            <strong>Status:</strong> 
            {% if post.status == 'published' %}
                This post is currently <strong>Published</strong>.
            {% else %}
                This post is currently <strong>Unpublished</strong>.
            {% endif %}
        </div>
    </div>
    
    <!-- Form Section -->
    <div class="container py-4" style="border: 1px solid #ddd; border-radius: 8px; background-color: #f9f9f9;">
        <h4 class="mb-4">Edit Post</h4>

        <!-- Form -->
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form.as_p }}
            
            <!-- Button Section -->
            <div class="row mt-4">
                <div class="col-md-4 text-start">
                    <!-- Publish/Unpublish Buttons -->
                    {% if post.status == 'draft' %}
                        <button type="submit" name="publish" value="True" class="btn btn-success w-100">Publish</button>
                        <small class="text-muted d-block mt-2 text-center">You post will be made public. </small>
                    {% else %}
                        <button type="submit" name="unpublish" value="True" class="btn btn-warning w-100">Unpublish</button>
                        <small class="text-muted d-block mt-2 text-center">You post will be moved to drafts. </small>
                    {% endif %}
                </div>

                <div class="col-md-4 text-center">
                    <!-- Save Button -->
                    <button type="submit" class="btn btn-dark w-100">Save Changes</button>
                     <!-- Hint Text Below the Button -->
                    <small class="text-muted d-block mt-2">Your Post will be saved to drafts. </small>
                </div>

                <div class="col-md-4 text-end">
                    <!-- Cancel Button -->
                    <button type="submit" href="{% url 'post_detail' pk=post.pk %}" class="btn btn-outline-secondary w-100">Cancel</button>
                </div>
            </div>

            <!-- Delete Button -->
            {% if post.author == user %}
                <div class="mt-4 text-center">
                    <form action="{% url 'post_delete' pk=post.pk %}" method="POST" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger w-50" onclick="return confirm('Are you sure you want to delete this post?')">
                            Delete Post
                        </button>
                    </form>
                </div>
            {% endif %}
        </form>
    </div>

{% endblock %}